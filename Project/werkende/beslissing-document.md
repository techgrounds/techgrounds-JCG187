**inleiding**  
In het project is verzocht om een een omgeving te maken waarin op een goedkope manier een website draait die is gekoppele aan een sql database. De webserver moet via een management server, wat in een ander netwerk zit gemanaged moet worden. Daarnaast is de vereiste dat de wachtwoorden, secrets en certificaten veilig opgeslagen worden. Ook moet er een storage account zijn waar de post deployment script voor de database staat en als laatste moesten er back up's zijn voor verschillende services die geinstalleerd worden.  Daarnaast zijn er vereisten voor beveiliging en loadbalancing van het internetverkeer.
**beslissingen**  
- **Netwerk:** Er zijn twee virtuele netwerken nodig om zo de management server en de webserver van elkaar te scheiden waardoor dit meer veiligheid geeft. Er is een vnet 10.10.10.0/24 met 2 subnets /25. Eén voor de webserver en één voor de application gateway die verzocht is. De application gateway heeft als vereiste dat die op een apart subnet wordt geinstalleerd. Het andere vnet is 10.20.20.0/24 met als subnet 10.20.20.0/25. Mocht er nog een subnet nodig zijn dan kan die aangemaakt worden.  Beide netwerken zijn via peering aan elkaar gekoppeld zodat ze kunnen communiceren met elkaar. De subnets worden beveiligd dmv NSG. Dat is de goedkoopste manier van beveiliging. Er zijn minimale poorts opengezet met gespecificeerde ip adressen die toegang hebben naar de resources.
- **webserver:** De webserver is geplaatst op het eerste vnet. Omdat er aangegeven werd dat er niet veel hits op de webserver zouden komen, is het voor de klant het voordeligste om een Ubuntu virtuele machine aan te maken waar een apache web server op is geinstalleerd. De vereiste was dat de webserver automatisch up- en downscaled. Hierdoor is er gekozen voor een vmss scale set. Om er voor te zorgen dat de webserver goed beschikbaar blijft, is deze in twee zone's geplaatst als verzocht door de klant. Op verzoek van de klant is er een application gateway als loadbalancer gebruikt. Voor beschikbaarheid is de webserver op 2 zones geplaatst.   
- **Managementserver:** Als eis is gesteld dat de webserver gemanaged moest worden door een management server vanuit het tweede netwerk. De management server moest als een soort proxy fungeren naar de webserver toe. Hiermee wordt de toegang naar de webserver vergroot. Een logisch en voordelig product is een vm met een windows server erop geinstalleerd. Daarmee kan gemakkelijk verbinding gemaakt kan worden via SSH (als vereist) naar de webserver.  
- **SQL server:** Er is gekozen voor Azure SQL Database. Dit is een managed database. Beveiliging, updating, backup en bereikbaarheid zijn door Microsoft geregeld waardoor de vereiste die ervoor waren zijn afgedekt. Omdat het gebasseerd is op pay as you go principe is het een goedkope optie. De database wil de klant later zelf deployen waardoor het script hiervoor op de storage account wordt geplaatst
- **Storage account:** Er is een 'hot blobstorage aangemaakt zodat de post deploymentscript voor de database snel benaderbaar is. De klant kan dit script makkelijk weer verwijderen via het portaal of via de Microsoft Azure Storage Explorer die via de site van Microsoft te downloaden is.  
- **Recovery Vault:** De recovery vault is aangemaakt om hiermee back-ups te kunnen maken van de webserver, de SQL database (extra backup) en de managementserver.  
- **Key Vault:** De key Vault bewaard alle sleutels, wachtwoorden, Certificaten en geheimen. De wachtwoorden voor de twee VM's, de SQL server, de Recovery service vault rn het certificaat voor de webserver voor de HTTPS verbinding kunnen hier worden opgeslagen. 