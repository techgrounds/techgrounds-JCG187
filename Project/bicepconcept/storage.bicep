param location string = resourceGroup().location //zorgt ervoor dat de installatie in de locatie van de resourcegroup plaatsvindt

param storageAccountName string = 'test123${uniqueString(resourceGroup().id)}'//zorgt voor een uniek achtervoegsel na de naam

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//nog nodig, een private endpoint en een virtueel netwerk
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


@description('creates the storage account')
resource storageAccount 'Microsoft.Storage/storageAccounts@2022-09-01' = {
  name: storageAccountName
  location: location
  sku: {
    name:'Standard_LRS' 
  }
  kind: 'StorageV2'
  properties: {
    accessTier: 'Hot'
    allowBlobPublicAccess: false    
    encryption: {
       identity: {
         
       }
    }
     networkAcls: {
      defaultAction:  'Allow'
      bypass:'None'
      ipRules: [
         {          
          value: '77.163.53.33'
          action:'Allow'          
         }
      ]   
            }
     publicNetworkAccess: 'Disabled'
  }  
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////CONTAINER//////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////

resource container 'Microsoft.Storage/storageAccounts/blobServices/containers@2022-09-01' = {
  name: 'test123storage'
  parent: blobservice
 
}








///////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////BLOBFOLDER///////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////




resource blobservice 'Microsoft.Storage/storageAccounts/blobServices@2022-09-01' = {
  name: 'default'
  parent: storageAccount

}



/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////MOGELIJKE BENODIGDE OUTPUTS//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////


output storageAccountID string = storageAccount.id




/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////WAARAAN MOET DEZE GEKOPPELD WORDEN?//////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////















